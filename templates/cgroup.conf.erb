<%# cgroup.conf.erb                                                          -%>
<%#                                                                          -%>
<%# Cgroup parameters for cgroup related SLURM plugins.                      -%>
<%#                                                                          -%>
<%# version 20170602                                                         -%>
<%#                                                                          -%>
<%# Copyright (c) CERN, 2016-2017                                            -%>
<%# Authors: - Philippe Ganz <phganz@cern.ch>                                -%>
<%#          - Carolina Lindqvist <calindqv@cern.ch>                         -%>
<%#          - Pablo Llopis <pablo.llopis@cern.ch>                           -%>
<%# License: GNU GPL v3 or later.                                            -%>
<%#                                                                          -%>
# /etc/slurm/cgroup.conf generated by puppet
#
# Parameters for plugins using cgroups
#

#################################
# General cgroup options

<% unless @cgroup_automount.nil? -%>CgroupAutomount=<%= @cgroup_automount %>
<% end -%>
CgroupMountpoint=<%= @cgroup_mountpoint %>


##################################
# TASK/CGROUP plugin configuration

# CPU
ConstrainCores=<%= @constrain_cores %>
<% unless @task_affinity.nil? -%>TaskAffinity=<%= @task_affinity %>
<% end -%>

# Memory
ConstrainRAMSpace=<%= @constrain_ram_space %>
AllowedRAMSpace=<%= @allowed_ram_space %>
MinRAMSpace=<%= @min_ram_space %>
MaxRAMPercent=<%= @max_ram_percent %>

# Swap
ConstrainSwapSpace=<%= @constrain_swap_space %>
AllowedSwapSpace=<%= @allowed_swap_space %>
MaxSwapPercent=<%= @max_swap_percent %>

<% unless @constrain_kmem_space.nil? && @allowed_kmem_space.nil? && @min_kmem_space.nil? && @max_kmem_percent.nil? -%># Kernel Memory
<% end -%>
<% unless @constrain_kmem_space.nil? -%>ConstrainKmemSpace=<%= @constrain_kmem_space %>
<% end -%>
<% unless @allowed_kmem_space.nil? -%>AllowedKmemSpace=<%= @allowed_kmem_space %>
<% end -%>
<% unless @min_kmem_space.nil? -%>MinKmemSpace=<%= @min_kmem_space %>
<% end -%>
<% unless @max_kmem_percent.nil? -%>MaxKmemPercent=<%= @max_kmem_percent %>
<% end -%>

# Devices
ConstrainDevices=<%= @constrain_devices %>
<% unless @allowed_devices_file.nil? -%>AllowedDevicesFile=<%= @allowed_devices_file %>
<% end -%>

